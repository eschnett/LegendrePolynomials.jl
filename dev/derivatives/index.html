<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Derivatives · LegendrePolynomials</title><link rel="canonical" href="https://jishnub.github.io/LegendrePolynomials.jl/derivatives/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">LegendrePolynomials</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Derivatives</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Analytical-approach-for-higher-derivatives"><span>Analytical approach for higher derivatives</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Derivatives</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Derivatives</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jishnub/LegendrePolynomials.jl/blob/master/docs/src/derivatives.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Derivatives-of-Legendre-Polynomials"><a class="docs-heading-anchor" href="#Derivatives-of-Legendre-Polynomials">Derivatives of Legendre Polynomials</a><a id="Derivatives-of-Legendre-Polynomials-1"></a><a class="docs-heading-anchor-permalink" href="#Derivatives-of-Legendre-Polynomials" title="Permalink"></a></h1><p>The Julia automatic differentiation framework may be used to compute the derivatives of Legendre polynomials alongside their values. Since the defintions of the polynomials are completely general, they may be called with dual or hyperdual numbers as arguments to evaluate derivarives in one go.  We demonstrate one example of this using the package <a href="https://github.com/JuliaDiff/HyperDualNumbers.jl"><code>HyperDualNumbers.jl</code></a> v4:</p><pre><code class="language-julia-repl">julia&gt; x = 0.5;

julia&gt; Pl(x, 3)
-0.4375

julia&gt; using HyperDualNumbers

julia&gt; xh = Hyper(x, one(x), one(x), zero(x));

julia&gt; p = Pl(xh, 3)
-0.4375 + 0.375ε₁ + 0.375ε₂ + 7.5ε₁ε₂</code></pre><p>The Legendre polynomial <span>$P_\ell(x)$</span> may be obtained using </p><pre><code class="language-julia-repl">julia&gt; realpart(p)
-0.4375</code></pre><p>The first derivative <span>$dP_\ell(x)/dx$</span> may be obtained as </p><pre><code class="language-julia-repl">julia&gt; ε₁part(p)
0.375</code></pre><p>The second derivative <span>$d^2P_\ell(x)/dx^2$</span> may be obtained using </p><pre><code class="language-julia-repl">julia&gt; ε₁ε₂part(p)
7.5</code></pre><p>Something similar may also be evaluated for all <code>l</code> iteratively. For example, the function <code>collectPl</code> evaluates Legendre polynomials for the <code>HyperDualNumber</code> argument for a range of <code>l</code>:</p><pre><code class="language-julia-repl">julia&gt; collectPl(xh, lmax=4)
5-element OffsetArray(::Array{Hyper{Float64},1}, 0:4) with eltype Hyper{Float64} with indices 0:4:
                1.0 + 0.0ε₁ + 0.0ε₂ + 0.0ε₁ε₂
                0.5 + 1.0ε₁ + 1.0ε₂ + 0.0ε₁ε₂
             -0.125 + 1.5ε₁ + 1.5ε₂ + 3.0ε₁ε₂
        -0.4375 + 0.375ε₁ + 0.375ε₂ + 7.5ε₁ε₂
 -0.2890625 - 1.5625ε₁ - 1.5625ε₂ + 5.625ε₁ε₂</code></pre><p>We may extract the first derivatives by broadcasting the function <code>ε₁part</code> on the array as:</p><pre><code class="language-julia-repl">julia&gt; ε₁part.(collectPl(xh, lmax=4))
5-element OffsetArray(::Array{Float64,1}, 0:4) with eltype Float64 with indices 0:4:
  0.0
  1.0
  1.5
  0.375
 -1.5625</code></pre><p>Similarly the function <code>ε₁ε₂part</code> may be used to obtain the second derivatives. </p><p>Several convenience functions to compute the derivatives of Legendre polynomials were available in <code>LegendrePolynomials</code> v0.2, but have been removed in v0.3. The users are encouraged to implement convenience functions to extract the derivatives as necessary. As an exmaple, we may compute the polynomials and their first and second derivatives together as</p><pre><code class="language-julia-repl">julia&gt; using HyperDualNumbers

julia&gt; function Pl_dPl_d2Pl(x; lmax)
           xh = Hyper(x, one(x), one(x), zero(x))
           p = collectPl(xh, lmax = lmax)
           realpart.(p), ε₁part.(p), ε₁ε₂part.(p)
       end
Pl_dPl_d2Pl (generic function with 1 method)

julia&gt; Pl_dPl_d2Pl(0.5, lmax = 3)
([1.0, 0.5, -0.125, -0.4375], [0.0, 1.0, 1.5, 0.375], [0.0, 0.0, 3.0, 7.5])</code></pre><h1 id="Analytical-approach-for-higher-derivatives"><a class="docs-heading-anchor" href="#Analytical-approach-for-higher-derivatives">Analytical approach for higher derivatives</a><a id="Analytical-approach-for-higher-derivatives-1"></a><a class="docs-heading-anchor-permalink" href="#Analytical-approach-for-higher-derivatives" title="Permalink"></a></h1><p>Legendre polynomials satisfy the differential equation </p><p class="math-container">\[\frac{d}{dx}\left[(1-x^2)\frac{d P_n}{dx} \right] + n(n+1) P_n(x) = 0\]</p><p>We may rearrange the terms to obtain </p><p class="math-container">\[\frac{d^2 P_n}{dx^2} = \frac{1}{(1-x^2)}\left( 2x \frac{d P_n(x)}{dx} - n(n+1)P_n{x} \right)\]</p><p>We may therefore compute the second derivative from the function and its first derivative. Higher derivatives may further be computed in terms of the lower ones.</p><p>We demonstrate the second-derivative computation using the package <a href="https://github.com/JuliaDiff/DualNumbers.jl"><code>DualNumbers.jl</code></a> v0.5: </p><pre><code class="language-julia-repl">julia&gt; using DualNumbers

julia&gt; x = 0.5;

julia&gt; xd = Dual(x, one(x));

julia&gt; d2Pl(x, P, dP, n) = (2x * dP - n*(n+1) * P)/(1 - x^2);

julia&gt; function d2Pl(x, n)
           xd = Dual(x, one(x))
           y = Pl(xd, n)
           P, dP = realpart(y), dualpart(y)
           d2Pl(x, P, dP, n)
       end;

julia&gt; d2Pl(x, 20)
32.838787646905985</code></pre><p>We may check that this matches the result obtained using <code>HyperDualNumbers</code>:</p><pre><code class="language-julia-repl">julia&gt; ε₁ε₂part(Pl(xh, 20))
32.838787646905985</code></pre><p>Unfortunately at this point, higher derivatives need to be evaluated analytically and expresed in terms of lower derivatives.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 5 January 2021 10:17">Tuesday 5 January 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
